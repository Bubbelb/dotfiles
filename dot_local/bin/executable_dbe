#!/bin/sh
if [ -f '/etc/bbsh' ] ; then
    echo "ERROR: Already in bbsh!" >&2
elif [ -f '/run/host/etc/passwd' ] ; then
    echo "ERROR: Already in a distrobox container!"
elif [ -z "${1}" ] ; then
    if [ -z "${SSH_CONNECTION}" ] ; then
        distrobox enter bbsh
    else
        distrobox enter bbsh -- tmux new-session -A -D
    fi
    echo "...Back in host..."

else
    distrobox enter bbsh -- $*
    echo "...Back in host..."
fi
